(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[640],{9685:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/rooms/[name]",function(){return r(414)}])},3972:function(e,n,r){"use strict";r.d(n,{a:function(){return a}});var t=r(5893),o=r(7294),i=r(7311),u=r(5591),s=function(e){var n=e.logLevel;(0,u.Ub)(null!=n?n:"debug");var r=(0,i.fZ)();o.useEffect(function(){return window.__lk_room=r,function(){window.__lk_room=void 0}})},a=function(e){return s({logLevel:e.logLevel}),(0,t.jsx)(t.Fragment,{})}},414:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return v}});var t=r(5893),o=r(7311),i=r(5591),u=r(9008),s=r.n(u),a=r(1163),c=r(7294),l=r(3972);function d(e,n,r,t,o,i,u){try{var s=e[i](u),a=s.value}catch(c){r(c);return}s.done?n(a):Promise.resolve(a).then(t,o)}var f=r(655),v=function(){var e=(0,a.useRouter)(),n=e.query.name,r=(0,c.useState)(void 0),i=r[0],u=r[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s(),{children:[(0,t.jsx)("title",{children:"LiveKit Meet"}),(0,t.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,t.jsx)("main",{"data-lk-theme":"default",children:n&&!Array.isArray(n)&&i?(0,t.jsx)(h,{roomName:n,userChoices:i,onLeave:function(){e.push("/")}}):(0,t.jsx)("div",{style:{display:"grid",placeItems:"center",height:"100%"},children:(0,t.jsx)(o.tt,{onError:function(e){return console.log("error while setting up prejoin",e)},defaults:{username:"",videoEnabled:!0,audioEnabled:!0},onSubmit:function(e){console.log("Joining with: ",e),u(e)}})})})]})},h=function(e){var n,r,u,s,v=e.roomName,h=e.userChoices,m=e.onLeave,g=(0,o.dQ)("/api/token",v,{userInfo:{identity:h.username,name:h.username}}),p=(0,a.useRouter)().query,_=p.region,w=p.hq,x=(u=(r=(0,c.useState)())[0],s=r[1],(0,c.useEffect)(function(){var e,n,r="/api/url";_&&(r+="?region=".concat(_)),fetch(r).then((e=function(e){var n;return(0,f.__generator)(this,function(r){switch(r.label){case 0:if(!e.ok)return[3,2];return[4,e.json()];case 1:return n=r.sent(),console.log(n),s(n.url),[3,3];case 2:throw Error("Error fetching server url, check server logs");case 3:return[2]}})},n=function(){var n=this,r=arguments;return new Promise(function(t,o){var i=e.apply(n,r);function u(e){d(i,t,o,u,s,"next",e)}function s(e){d(i,t,o,u,s,"throw",e)}u(void 0)})},function(e){return n.apply(this,arguments)}))}),u),j=(0,c.useMemo)(function(){var e,n;return{videoCaptureDefaults:{deviceId:null!==(e=h.videoDeviceId)&&void 0!==e?e:void 0,resolution:"true"===w?i.OM.h2160:i.OM.h720},publishDefaults:{videoSimulcastLayers:"true"===w?[i.OM.h1080,i.OM.h720]:[i.OM.h540,i.OM.h216]},audioCaptureDefaults:{deviceId:null!==(n=h.audioDeviceId)&&void 0!==n?n:void 0},adaptiveStream:{pixelDensity:"screen"},dynacast:!0}},[h,w]);return(0,t.jsx)(t.Fragment,{children:x&&(0,t.jsxs)(o.IC,{token:g,serverUrl:x,options:j,video:h.videoEnabled,audio:h.audioEnabled,onDisconnected:m,children:[(0,t.jsx)(o.zc,{chatMessageFormatter:o.x3}),(0,t.jsx)(l.a,{logLevel:i.in.info})]})})}}},function(e){e.O(0,[970,226,616,774,888,179],function(){return e(e.s=9685)}),_N_E=e.O()}]);